<!DOCTYPE html>
<html lang="en" xmlns="">
<head>
    <meta charset="UTF-8">
    <title>이준범</title>
    <link rel="icon" type="image/png" sizes="64x64" href="../res/prism_favicon_64.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style> @import url('https://fonts.googleapis.com/css2?family=Gamja+Flower&display=swap');

    * {
        font-family: "Gamja Flower", sans-serif;
        font-weight: 1500;
        font-size: 110%;
    }

    body {
        background-color: black;
    }

    #introduce {
        background-color: #101010; /* 배경 색 (검정 or 다른 컬러) */
        color: #ddd; /* 글자 색 */
        padding: 80px 210px;
        text-align: left;
    }

    .introduce_container {
        display: flex;
        justify-content: center; /* 전체 가운데 정렬 */
        align-items: center; /* 텍스트와 이미지 수직 가운데 정렬 */
        gap: 20px; /* 텍스트와 이미지 간격 */
        max-width: 1200px;
        margin: 0 auto;
    }

    .introduce_text {
        flex: 1; /* 텍스트 영역 자동 확장 */
    }

    #introduce h1 {
        font-size: 2.5rem;
        margin-bottom: 20px;
        color: #9aa5cb; /* 포인트 컬러 */
    }

    #introduce h3 {
        font-size: 1.1rem;
        line-height: 1.6;
        color: #b0becb;
    }

    #introduce p {
        max-width: 800px;
        margin: 0 auto;
        font-size: 1.1rem;
        line-height: 1.6;
    }

    .introduce_image {
        flex: 1;
        display: flex;
        justify-content: right;
    }

    .introduce_image img {
        margin-top: 100px;
        height: 300px;
        width: auto;
        border-radius: 10px;
    }


    #biography {
        display: flex;
        flex-direction: column; /* 이미지 위, 텍스트 아래 */
        align-items: center; /* 전체 중앙 정렬 */
        gap: 40px;
        padding: 60px 20px;
    }

    #biography img {
        height: 600px;
        width: 600px;
        object-fit: cover;
        border-radius: 10px;
        transition: opacity 0.5s ease-in-out; /* 부드럽게 전환 */
    }

    .image_wrapper {
        display: flex;
        flex-direction: column; /* 위: 이미지, 아래: 버튼 */
        align-items: center; /* 이미지는 가운데 정렬 */
        gap: 20px;
    }

    .image_container {
        display: flex;
        gap: 20px;
        justify-content: center; /* 이미지 두 개 나란히 가운데 */
    }

    .button_container {
        display: flex;
        justify-content: flex-end; /* 오른쪽 끝 정렬 */
        width: 100%; /* wrapper 기준 오른쪽 끝 */
        max-width: 1200px; /* 이미지 폭에 맞춰 정렬하려면 제한 */
        gap: 10px;
    }

    .button_container button {
        background: white;
        color: black;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 18px;
        cursor: pointer;
        transition: background 0.3s, transform 0.2s;
    }

    .button_container button:hover {
        background: #ddd;
        transform: scale(1.1);
    }

    /* 텍스트 영역 */
    .biography_list {
        width: 100%;
        max-width: 1200px;
        text-align: left; /* 텍스트 왼쪽 정렬 */
        color: #ddd;
    }

    .biography_list h2 {
        text-align: left;
        margin-top: 20px;
        margin-bottom: 10px;
        color: #b0becb;
    }

    .biography_list h3 {
        text-align: center;
        margin-top: 20px;
        margin-bottom: 10px;
        color: #a8b4cb;
    }

    hr {
        border: none;
        border-top: 1px solid #ccc;
        margin: 20px 0;
    }

    /* comment */
    /* 댓글 하나 */
    .comment {
        background: #1a1a1a;
        border: 1px solid #333;
        border-radius: 10px;
        padding: 15px 20px;
        color: #ddd;
        font-size: 1rem;
    }

    .comments_container {
        display: flex;
        flex-direction: column;
        gap: 15px;
        text-align: left;
        padding: 20px;
        border-radius: 10px;
    }

    /* input, textarea */
    .comments_container input, .comments_container textarea {
        width: 100%;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #444;
        background: #222;
        color: white;
        resize: none;
    }

    /* 작성 버튼 */
    .button_row {
        display: flex;
        justify-content: flex-end; /* 오른쪽 정렬 */
    }

    /* 댓글 헤더 (이름 + 날짜 + 버튼들) */
    .comment_header {
        display: flex;
        justify-content: space-between; /* 이름/날짜 왼쪽, 버튼 오른쪽 */
        align-items: center;
        margin-bottom: 10px;
    }


    /* 이름 + 날짜 묶음 */
    .comment_item {
        display: flex;
        flex-direction: column;
        gap: 3px;
    }

    .comment_name {
        font-weight: bold;
        font-size: 1.1rem;
        color: #88aacf; /* 포인트 컬러 */
        margin: 0;
    }

    .comment_date {
        font-size: 0.85rem;
        color: #aaa;
        margin: 0;
    }

    /* 내용 */
    .comment_content {
        background: #222;
        padding: 12px;
        border-radius: 8px;
        line-height: 1.5;
        color: #ddd;
    }

    /* 버튼 영역 */
    .comment_header .button {
        display: flex;
        gap: 8px;
    }

    .comment_header .button button {
        background: #333;
        color: #ddd;
        border: none;
        border-radius: 6px;
        padding: 5px 12px;
        font-size: 0.9rem;
        cursor: pointer;
        transition: background 0.2s, transform 0.2s;
    }

    .comment_header .button button:hover {
        background: #555;
        transform: scale(1.05);
    }

    .comment_header .button .delete:hover {
        background: #aa4444;
    }

    footer {
        text-align: center;
        padding: 20px;
        margin-top: 40px;
        font-size: 0.9rem;
        color: #666;
    }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="module">
        // Firebase SDK 라이브러리 가져오기
        import {initializeApp} from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import {
            addDoc,
            collection,
            deleteDoc,
            doc,
            getDocs,
            getFirestore,
            orderBy,
            query,
            serverTimestamp,
            updateDoc
        } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA0OXWG80hRqnzuEB5ytI1oxjdcHthYxoE",
            authDomain: "sparta-a78a3.firebaseapp.com",
            projectId: "sparta-a78a3",
            storageBucket: "sparta-a78a3.firebasestorage.app",
            messagingSenderId: "692256143426",
            appId: "1:692256143426:web:a279269d0bca7c94b515db",
            measurementId: "G-PKVDT9GBHF"
        };

        // Firebase 인스턴스 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        //쓰기
        $("#submit_comment").click(async function () {
            let name = $('#name').val();
            let content = $('#content').val();
            let date = serverTimestamp();

            if (name == null || content == null) {
                alert('이름이나 내용을 확인해주세요.');
            } else {
                try {
                    let doc = {
                        'name': name,
                        'content': content,
                        'date': date
                    };
                    await addDoc(collection(db, 'comments'), doc);
                    alert('방명록에 글 쓰셨어요');
                    window.location.reload();
                } catch (e) {
                    console.error("Error adding document: ", e);
                }
            }
        })

        //읽어오기
        let docs = await getDocs(query(collection(db, "comments"), orderBy("date", "desc")));

        docs.forEach((doc) => {
            let row = doc.data();
            let id = doc.id;
            let name = row['name'];
            let content = row['content'];
            let date = row['date'].toDate().toLocaleString();

            let temp_html = `<div class="comment" data-id="${id}">
                <div class="comment_header">
                    <div class="comment_item">
                        <p class="comment_name">${name}</p>
                        <p class="comment_date">${date}</p>
                        <div class="comment_content">
                            ${content}
                        </div>
                    </div>
                    <div class="button">
                        <button class="modify" type="button">수정</button>
                        <button class="delete" type="button">삭제</button>
                    </div>
                </div>
            </div>`;


            $('#comment_show').append(temp_html);
        });

        // 수정 버튼 클릭 → textarea로 변환
        $(document).on('click', '.modify', function () {
            let commentBox = $(this).closest('.comment_box');
            let fixContent = commentBox.find('.content');
            let oldContent = fixContent.text();

            // textarea로 교체
            fixContent.replaceWith(`<textarea class="editContent">${oldContent}</textarea>`);

            // 버튼 상태 변경
            $(this).text("저장").removeClass("modify").addClass("save");
        });

        // 저장 버튼 클릭 → Firestore 업데이트
        $(document).on('click', '.save', async function () {
            let commentBox = $(this).closest('.comment_box');
            let id = commentBox.data('id'); // Firestore 문서 id
            let newContent = commentBox.find('.editContent').val();

            try {
                await updateDoc(doc(db, "comments", id), {
                    content: newContent
                });
                alert("댓글이 수정되었습니다!");
                window.location.reload();
            } catch (e) {
                console.error("Error updating document: ", e);
            }
        });

        //삭제
        $(document).on('click', '.delete', async function () {
            //일치하는 comment_box 찾을 때까지 순회
            let id = $(this).closest('.comment_box').data('id'); // 클릭한 댓글의 id
            console.log(id);

            try {
                await deleteDoc(doc(db, "comments", id));
            } catch (e) {
                console.error("Error deleting document: ", e);
            }
            alert("댓글이 삭제되었습니다!");
            window.location.reload();
        });

    </script>
    <script> $(function () {
        const images = [
            'https://apricot-nose-2df.notion.site/image/attachment%3Aa085e94a-a526-4791-ae10-933263fe684a%3AIMG_0190.jpeg?table=block&id=27f555a1-c11f-80df-b652-eb7c085fbe9f&spaceId=376555a1-c11f-813c-a204-000349085a2a&width=1420&userId=&cache=v2',
            'https://apricot-nose-2df.notion.site/image/attachment%3A680ebafe-e05e-42aa-a182-218b514b0e85%3AIMG_0191.jpeg?table=block&id=27f555a1-c11f-8063-ab6f-eb9ba9cd2127&spaceId=376555a1-c11f-813c-a204-000349085a2a&width=1420&userId=&cache=v2',
            'https://apricot-nose-2df.notion.site/image/attachment%3A055b01c2-41a6-4490-a011-6bf08fc17192%3AIMG_0059.jpeg?table=block&id=27f555a1-c11f-8094-8260-e853913b76ef&spaceId=376555a1-c11f-813c-a204-000349085a2a&width=1420&userId=&cache=v2',
            'https://apricot-nose-2df.notion.site/image/attachment%3A20f26183-624c-4a66-a9ca-7c1b08cdf795%3AIMG_0734.jpeg?table=block&id=27f555a1-c11f-802a-bcad-e24b12eeb64f&spaceId=376555a1-c11f-813c-a204-000349085a2a&width=1420&userId=&cache=v2',
            'https://apricot-nose-2df.notion.site/image/attachment%3A6b314c64-2691-4168-b7c8-d1f4216c8227%3AIMG_0879.jpeg?table=block&id=27f555a1-c11f-80a2-8f6f-d81656188745&spaceId=376555a1-c11f-813c-a204-000349085a2a&width=1420&userId=&cache=v2',
            'https://apricot-nose-2df.notion.site/image/attachment%3Acf3b5ae1-8236-4949-9d2b-9e2ec1935acd%3AIMG_0687.jpeg?table=block&id=27f555a1-c11f-8006-9b4b-f17f6b80de97&spaceId=376555a1-c11f-813c-a204-000349085a2a&width=1420&userId=&cache=v2',
            'https://apricot-nose-2df.notion.site/image/attachment%3Aff421ef4-2dd8-4a58-8d5c-2af6a90b16e2%3AIMG_0733.jpeg?table=block&id=27f555a1-c11f-80f5-8ca1-d74c71a69334&spaceId=376555a1-c11f-813c-a204-000349085a2a&width=1420&userId=&cache=v2',
            'https://apricot-nose-2df.notion.site/image/attachment%3A0eeffc43-a407-494f-899a-3d5cfbb63990%3AIMG_0697.jpeg?table=block&id=27f555a1-c11f-80a6-8a36-f526bf5168a1&spaceId=376555a1-c11f-813c-a204-000349085a2a&width=1420&userId=&cache=v2'];
        let currentIndex = 0;

        function updateImages() {
            $(".bio_image").each(function (i) {
                const newSrc = images[(currentIndex + i) % images.length];
                $(this).css("opacity", 0); // 서서히 사라짐
                setTimeout(() => {
                    $(this).attr("src", newSrc);
                    $(this).css("opacity", 1); // 서서히 나타남
                }, 300);
            });
        }

        $("#prevButton").click(function () {
            currentIndex = (currentIndex - 2 + images.length) % images.length;
            updateImages();
        });
        $("#nextButton").click(function () {
            currentIndex = (currentIndex + 2) % images.length;
            updateImages();
        });
        // 초기 실행
        updateImages();
    });
    </script>
</head>

<body>
<!-- introduce -->
<section id="introduce">
    <div class="introduce_container">
        <!-- 왼쪽 텍스트 -->
        <div class="introduce_text">
            <h1>Introduce</h1>
            <h3>이준범 | <a href="https://github.com/junbeom95-lee">github</a></h3>
            <p>
                안녕하세요!<br>
                저는 자바와 스프링에 관심이 많은 개발자 이준범입니다.<br>
                새로운 기술을 배우고 직접 만들어내는 걸 좋아합니다.<br>
                감사합니다.
            </p>
        </div>
        <!-- 오른쪽 이미지 -->
        <div class="introduce_image">
            <img src="https://apricot-nose-2df.notion.site/image/attachment%3Add5cf13a-c331-4255-8858-432c8288bf22%3Ajunbeum.jpg?table=block&id=27f555a1-c11f-8035-b633-ff9d01aa83b8&spaceId=376555a1-c11f-813c-a204-000349085a2a&width=1420&userId=&cache=v2"
                 alt="myImage">
        </div>
    </div>
</section>
<!-- Biography -->
<section id="biography">
    <!-- 이미지 + 버튼 -->
    <div class="image_wrapper">
        <!-- 이미지 두 개 묶음 -->
        <div class="image_container">
            <div class="image_box">
                <img class="bio_image" alt="profileImage1">
            </div>
            <div class="image_box">
                <img class="bio_image" alt="profileImage2">
            </div>
        </div>

        <!-- 버튼 (이미지 전체 밑, 오른쪽 끝) -->
        <div class="button_container">
            <button id="prevButton">←</button>
            <button id="nextButton">→</button>
        </div>
    </div>

    <!-- 텍스트 영역 -->
    <div class="biography_list"><h2>Biography</h2>
        <div class="row">
            <div class="col-md-4"><h3>기본 소개</h3>
                <hr>
                <ul>
                    <li>나이 : 31살</li>
                    <li>MBTI : ISFJ</li>
                </ul>
            </div>
            <div class="col-md-4"><h3>취미</h3>
                <hr>
                <ul>
                    <li>노래듣기</li>
                    <li>게임</li>
                </ul>
            </div>
            <div class="col-md-4"><h3>제 주인님</h3>
                <hr>
                <ul>
                    <li>성함 : 달이</li>
                    <li>나이 : 4살</li>
                </ul>
            </div>
        </div>
    </div>
</section>
<section id="comment">
    <div class="comments_container">
        <label for="name">집사 :</label>
        <input type="text" name="name" id="name" placeholder="이름을 적어주세요">
        <label for="content">주인님께 한마디: </label>
        <textarea name="content" id="content"></textarea>
        <div class="button_row">
            <button type="button" class="create" id="submit_comment">작성</button>
        </div>
    </div>
    <div class="comment_list" id="comment_show">
        <div id="comment_list">
            <!-- 예시 댓글 -->
            <div class="comment" data-id="${id}">
                <div class="comment_header">
                    <div class="comment_item">
                        <p class="comment_name">이름</p>
                        <p class="comment_date">날짜</p>
                        <div class="comment_content">
                            여기에 내용?
                        </div>
                    </div>
                    <div class="button">
                        <button class="modify" type="button">수정</button>
                        <button class="delete" type="button">삭제</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<footer>
    <div>ⓒ달이</div>
</footer>
</body>
</html>